generator db {
  provider = "go run github.com/steebchen/prisma-client-go"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id         String    @id @db.Char(36)
  email      String
  password   String
  created_at DateTime  @default(now())
  updated_at DateTime?

  reading Reading[]

  @@map("users")
}

model Book {
  id           String    @id @db.Char(36)
  title        String    @default("")
  genre        String    @default("")
  total_page   Int       @default(0)
  author       String    @default("")
  publisher    String    @default("")
  published_at Int       @db.Year
  price        Decimal   @default(0) @db.Decimal(10, 2)
  created_at   DateTime  @default(now())
  updated_at   DateTime?
  reading      Reading[]

  @@map("books")
}

model Reading {
  id            BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  user_id       String    @db.Char(36)
  book_id       String    @db.Char(36)
  progress_page Int       @default(0)
  created_at    DateTime  @default(now())
  updated_at    DateTime?

  book   Book    @relation(fields: [book_id], references: [id])
  user   User    @relation(fields: [user_id], references: [id])
  review Review?

  @@map("readings")
}

model Review {
  id             BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  review_content String?
  review_id      BigInt    @unique @db.UnsignedBigInt
  created_at     DateTime  @default(now())
  updated_at     DateTime?
  reading        Reading   @relation(fields: [review_id], references: [id])

  @@map("reviews")
}
